<div align="center">
<pre>
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                   â•‘
â•‘   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—   â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â•‘
â•‘   â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â•‘
â•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â•‘
â•‘   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â•‘
â•‘   â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•šâ•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•   â•‘
â•‘                                                                                   â•‘
â•‘                               MediaSmith v2.2                                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</pre>
</div>

<p align="center">
	<em><code>â¯ Advanced multimedia processing with multi-mode execution and real-time monitoring</code></em>
</p>

<p align="center">
	<img src="https://img.shields.io/badge/version-2.2-blue.svg" alt="version">
	<img src="https://img.shields.io/badge/license-MIT-green.svg" alt="license">
	<img src="https://img.shields.io/badge/shell-bash-orange.svg" alt="shell">
	<img src="https://img.shields.io/badge/platform-Linux%20%7C%20macOS-lightgrey.svg" alt="platform">
</p>

## ğŸ”— Table of Contents
- [ğŸ“ Overview](#-overview)
- [ğŸš€ Getting Started](#-getting-started)
- [ğŸ¤– Usage](#-usage)
- [âš¡ Real-time Monitoring](#-real-time-monitoring)
- [ğŸ”§ Execution Modes](#-execution-modes)
- [ğŸ”„ Remote Backup System](#-remote-backup-system)
- [âš™ï¸ Configuration Management](#-configuration-management)
- [ğŸ”§ Administrative Commands](#-administrative-commands)
- [ğŸ“Š Testing](#-testing)
- [ğŸ” Troubleshooting](#-troubleshooting)
- [ğŸ“ Project Structure](#-project-structure)

---

## ğŸ“ Overview

**MediaSmith** is a powerful multimedia processing script that handles video, audio, and image conversions with support for multiple execution modes, real-time monitoring, and automated processing workflows.

### Core Philosophy
- **Cross-Platform**: Works on Linux and macOS with optimized monitoring for each platform
- **Multiple Execution Modes**: Choose the right mode for your performance needs
- **Real-time Processing**: Automatic file detection and processing with `inotifywait` (Linux) or `fswatch` (macOS)
- **Simple Configuration**: Easy setup with sensible defaults

## ğŸš€ Getting Started

### Quick Setup
```bash
# 1. Install all dependencies automatically
make all

# 2. Generate test files for development
make test

# 3. Run first conversion
./mediasmith.sh sample_file.jpg
```

### Manual Setup (Alternative)
```bash
# 1. Make executable
chmod +x mediasmith.sh

# 2. Install dependencies manually
./scripts/deps_check.sh

# 3. Run first conversion
./mediasmith.sh sample_file.jpg
```

### Dependencies
- **Required**: `ffmpeg`, `imagemagick`, `bash` (4.0+)
- **Linux**: `inotify-tools` for real-time monitoring
- **macOS**: `fswatch` for real-time monitoring (install via Homebrew)

### Build System Commands
| Command | Description |
|---------|-------------|
| `make all` | Install dependencies and build binaries |
| `make build` | Compile the C thread helper only |
| `make scripts-perm` | Make all scripts executable |
| `make deps` | Install system dependencies |
| `make test` | Generate test files |
| `make clean` | Clean build artifacts |

## ğŸ¤– Usage

### Basic Conversion
```bash
# Convert a single file
./mediasmith.sh image.jpg

# Convert a directory recursively
./mediasmith.sh -R /path/to/media/

# Custom output directory and format
./mediasmith.sh -o converted/ -v webm video.mp4
```

### Core Options
| Option | Description |
|--------|-------------|
| `-h` | Show help |
| `-R` | Process recursively |
| `-o <dir>` | Output directory |
| `-v <ext>` | Video format (mp4, webm, avi) |
| `-a <ext>` | Audio format (mp3, flac, wav) |
| `-i <ext>` | Image format (jpg, png, webp) |

## âš¡ Real-time Monitoring

MediaSmith supports real-time file monitoring on both Linux and macOS platforms.

### Linux (inotify)
```bash
# Install inotify-tools
sudo apt-get install inotify-tools  # Ubuntu/Debian
sudo yum install inotify-tools      # CentOS/RHEL

# Start monitoring
./mediasmith.sh --watch
```

### macOS (fswatch)
```bash
# Install fswatch via Homebrew
brew install fswatch

# Start monitoring
./mediasmith.sh --watch

# Run the script in background as Daemon
./mediasmith.sh --watch --daemon
```

### How it Works
1. **Automatic Detection**: MediaSmith detects available monitoring tools
2. **Fallback Mode**: If no monitoring tools are available, uses polling
3. **Instant Processing**: New files are processed immediately when detected
4. **Background Operation**: Monitoring runs in the background

### Monitoring Configuration
```bash
# Configure monitoring settings
./mediasmith.sh -c

# Key settings:
# - WATCH_DIR: Directory to monitor (default: ./files/)
# - WATCH_INTERVAL: Polling interval for fallback mode
# - AUTO_PROCESS: Enable/disable automatic processing
```

### Example Workflow
```bash
# Start monitoring in background
./mediasmith.sh --watch &

# Copy files to watch directory
cp *.jpg files/
# Files are automatically converted!

# Check results
ls out/
```

## ğŸ”§ Execution Modes

Choose the execution mode that fits your needs:

### Normal Mode (Default)
```bash
./mediasmith.sh file.jpg
```
- **Best for**: Single files, interactive use
- **Characteristics**: Synchronous, full terminal output

### Fork Mode (`-f`)
```bash
./mediasmith.sh -f directory/ -r
```
- **Best for**: Background batch processing
- **Characteristics**: Non-blocking, runs in background

### Subshell Mode (`-s`)
```bash
./mediasmith.sh -s file.mp4
```
- **Best for**: Isolated processing, testing
- **Characteristics**: Process isolation, protected environment

### Thread Mode (`-t`)
```bash
./mediasmith.sh -t directory/
```
- **Best for**: High-performance batch operations
- **Characteristics**: Multi-threaded C helper, parallel processing

### Thread Mode Performance
- **Multi-core utilization**: Automatically detects CPU cores
- **Parallel processing**: Up to 16 concurrent conversions
- **Progress monitoring**: Real-time conversion statistics
- **Optimal for**: Large batch operations (100+ files)

```bash
# High-performance batch processing
./mediasmith.sh -t /large/media/directory/
```

## ğŸ”„ Remote Backup System

MediaSmith includes automated backup functionality with cloud storage support.

### Setup Remote Backup
```bash
# Interactive setup for cloud backup
./scripts/setup_remote_backup.sh

# Test backup configuration
./scripts/test_remote_backup.sh

# Manual backup trigger
./mediasmith.sh --backup
```

### Supported Storage Features
- **rclone** integration for different cloud providers
- **Automatic file synchronization** after conversion
- **Backup status tracking** and logging
- **Date-based backup organization**

### Backup Configuration
The backup system uses the following structure:
- `backup/` - Local backup storage
- `logs/backed_up.log` - Backup history
- `logs/to_backup.log` - Files queued for backup

### Example Backup Workflow
```bash
# Setup remote backup destination
./scripts/setup_remote_backup.sh

# Convert files (automatically queued for backup)
./mediasmith.sh video.mp4

# Check backup status
cat logs/backed_up.log
```

## âš™ï¸ Configuration Management

MediaSmith provides comprehensive configuration management through interactive and file-based settings.

### Interactive Configuration
```bash
# Launch configuration editor
./mediasmith.sh -c

# Available configuration options:
LOG_LEVEL="INFO"                    # Logging verbosity (DEBUG, INFO, WARN, ERROR)
DEFAULT_OUT_DIR="out"               # Default output directory
WATCH_INTERVAL="2"                  # Polling interval for file monitoring
default_video_ext="mp4"             # Default video output format
default_audio_ext="mp3"             # Default audio output format  
default_image_ext="jpg"             # Default image output format
REMOTE_DIR="backup_remote"          # Remote backup directory path
```

### Configuration Files
- `config/config.cfg` - Main configuration file
- `config/config.example.cfg` - Template with all available options

### Advanced Configuration
```bash
# Custom configuration file
./mediasmith.sh --config /path/to/custom.cfg

# Override specific settings
LOG_LEVEL=DEBUG ./mediasmith.sh file.jpg

# Reset to defaults
./mediasmith.sh --restore-defaults
```

## ğŸ”§ Administrative Commands

MediaSmith provides several administrative commands for system management.

### System Administration
```bash
# Restore default configuration (requires sudo)
sudo ./mediasmith.sh --restore

# Custom log directory
sudo ./mediasmith.sh -l /custom/log/path

# Check dependencies
./scripts/deps_check.sh
```

### Log Management
```bash
# View conversion history
cat logs/converted_files.log

# View backup history
cat logs/backed_up.log

# View general system history
cat logs/history.log

```

## ğŸ“Š Testing

### Quick Test
```bash
# Generate test files for development
make test
```

### Test File Generation
The `make test` command executes `populate_test_files.sh` which creates a directory containing:
- Sample images (JPG, PNG, WebP)
- Sample videos (MP4, AVI)
- Sample audio files (MP3, WAV)

## ğŸ” Troubleshooting

### Common Issues
- **Thread helper not found**: Run `make build` to compile the C helper
- **Permission denied**: Use `sudo ./mediasmith.sh --restore` to fix permissions
- **Monitoring not working**: Install `inotify-tools` (Linux) or `fswatch` (macOS)
- **Remote backup failing**: Run `./scripts/test_remote_backup.sh` to diagnose

### Debug Mode
```bash
# Enable debug logging
LOG_LEVEL=DEBUG ./mediasmith.sh file.jpg

# View detailed logs
tail -f logs/history.log
```

### Performance Issues
```bash
# Use thread mode for large batches
./mediasmith.sh -t /large/directory/

# Monitor conversion progress
watch -n 1 'ls -la out/'
```

### Configuration Problems
```bash
# Reset to default configuration
./mediasmith.sh --restore-defaults

# Verify configuration
./mediasmith.sh -c
```

---

## ğŸ“ Project Structure
```
mediasmith/
â”œâ”€â”€ mediasmith.sh           # Main script
â”œâ”€â”€ makefile                # Build and setup automation
â”œâ”€â”€ README.md               # Project documentation
â”œâ”€â”€ .gitignore              # Git ignore rules
â”œâ”€â”€ backup/                 # Backup storage
â”‚   â””â”€â”€ 2025-06-04/         # Date-based backups
â”œâ”€â”€ bin/                    # Compiled binaries
â”‚   â””â”€â”€ thread_converter    # Multi-threaded converter binary
â”œâ”€â”€ config/                 # Configuration files
â”‚   â”œâ”€â”€ config.cfg          # Main configuration
â”‚   â””â”€â”€ config.example.cfg  # Configuration template
â”œâ”€â”€ files/                  # Input directory (watched)
â”‚   â”œâ”€â”€ sample1.mp4         # Test video file
â”‚   â”œâ”€â”€ sample2.mkv         # Test video file
â”‚   â”œâ”€â”€ sample3.wav         # Test audio file
â”‚   â”œâ”€â”€ sample4.flac        # Test audio file
â”‚   â”œâ”€â”€ sample5.png         # Test image file
â”‚   â””â”€â”€ sample6.jpg         # Test image file
â”œâ”€â”€ lib/                    # Core modules
â”‚   â”œâ”€â”€ backup.sh           # Backup functionality
â”‚   â”œâ”€â”€ conversion.sh       # Conversion logic
â”‚   â”œâ”€â”€ logging.sh          # Logging system
â”‚   â”œâ”€â”€ utils.sh            # Utilities
â”‚   â””â”€â”€ watcher.sh          # File monitoring
â”œâ”€â”€ logs/                   # Log files
â”‚   â”œâ”€â”€ backed_up.log       # Backup history
â”‚   â”œâ”€â”€ converted_files.log # Conversion history
â”‚   â”œâ”€â”€ history.log         # General history
â”‚   â””â”€â”€ to_backup.log       # Files to backup
â”œâ”€â”€ out/                    # Output directory
â”‚   â”œâ”€â”€ audios/             # Converted audio files
â”‚   â”œâ”€â”€ images/             # Converted image files
â”‚   â””â”€â”€ videos/             # Converted video files
â”œâ”€â”€ scripts/                # Utility scripts
â”‚   â”œâ”€â”€ deps_check.sh       # Dependency checker
â”‚   â”œâ”€â”€ populate_test_files.sh # Test file generator
â”‚   â”œâ”€â”€ setup_remote_backup.sh # Remote backup setup
â”‚   â””â”€â”€ test_remote_backup.sh  # Backup testing
â””â”€â”€ src/                    # Source code
    â””â”€â”€ thread_converter.c  # C source for multi-threaded converter
```

## ğŸ— License

MIT License - see LICENSE file for details.

---

**MediaSmith v2.2** - Simple, powerful, cross-platform multimedia processing.
